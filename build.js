!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.EventSky=t()}(this,function(){"use strict";var e={createNewEventMap:function(){return{handlers:0,_handlers:0,on:{},once:{},beforeAll:{},afterAll:{}}}},t={setExpectedEvents:function(e){return this.config.restrictToExpected=!0,this}},r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();return new(function(){function o(){var n=this;r(this,o),this.config={restrictToExpected:!1,firehose:!1},this._config=t,this._utils=e,this.events={},this._firehose=function(e){return n.config.firehose?console.log("EventSky Firehose >> "+e):null};var s=function(e){return function(t,r){if("string"!=typeof t||t.length<1||"function"!=typeof r)return console.warn('EventSky warning: "'+t+'" event must be a string and handler must be a function - not set with .'+e+" handler"),n;if(n.config.restrictToExpected&&!Object.keys(n.events).includes(t))return n._firehose('"'+t+'" handler cannot be set because it is not an expected event "restrictToExpected = true"'),n;n.events[t]||(n.events[t]=n._utils.createNewEventMap()),n.events[t].handlers++;var o=n.events[t]._handlers++,s=t+"."+e+"."+o;return n.events[t][e][s]=r,s}};this.on=s("on"),this.once=s("once"),this.beforeAll=s("beforeAll"),this.afterAll=s("afterAll")}return n(o,[{key:"off",value:function(e,t){var r=this;return Object.keys(this.events).forEach(function(n){Object.keys(r.events[n]).forEach(function(o){["beforeAll","on","once","afterAll"].includes(o)&&Object.keys(r.events[n][o]).forEach(function(s){(!t&&s===e||r.events[n][o][s]===t)&&(delete r.events[n][o][s],r.events[n].handlers--)})})}),this}},{key:"trigger",value:function(e,t){var r=this;if(this.config.restrictToExpected){if(!Object.keys(this.events).includes(e))return this._firehose('"'+e+'" triggered and is not an expected event "restrictToExpected = true"'),this}else if(!this.events[e])return this._firehose('"'+e+'" triggered with no handlers setup'),this;this._firehose('"'+e+'" triggered');var n=this.events[e].beforeAll;try{Object.keys(n).forEach(function(e){return n[e](t)})}catch(r){console.error("EventSky error: "+e+" beforeAll handler errored",{error:r,data:t})}var o=this.events[e].on;try{Object.keys(o).forEach(function(e){return o[e](t)})}catch(r){console.error("EventSky error: "+e+" on handler errored",{error:r,data:t})}var s=this.events[e].once;try{Object.keys(s).forEach(function(n){s[n](t),r.off(e,s[n](t))})}catch(r){console.error("EventSky error: "+e+" once handler errored",{error:r,data:t})}var i=this.events[e].afterAll;try{Object.keys(i).forEach(function(e){return i[e](t)})}catch(r){console.error("EventSky error: "+e+" afterAll handler errored",{error:r,data:t})}return this}}]),o}())});
//# sourceMappingURL=build.js.map
